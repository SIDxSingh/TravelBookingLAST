<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin - Contact Messages - TravelEase</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&family=Montserrat:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/style.css">
    <style>
        .admin-panel {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem;
        }
        
        .admin-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 3rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid #e0e0e0;
        }
        
        .admin-title {
            font-size: 2.4rem;
            font-weight: 600;
        }
        
        .admin-actions {
            display: flex;
            gap: 1rem;
        }
        
        .admin-tabs {
            display: flex;
            border-bottom: 1px solid #e0e0e0;
            margin-bottom: 2rem;
        }
        
        .tab {
            padding: 1rem 2rem;
            cursor: pointer;
            font-weight: 500;
            font-size: 1.6rem;
            position: relative;
            display: flex;
            align-items: center;
            gap: 0.8rem;
        }
        
        .tab i {
            font-size: 1.8rem;
        }
        
        .tab.active {
            color: var(--primary-color);
            border-bottom: 2px solid var(--primary-color);
        }
        
        .count-badge {
            background-color: var(--primary-color);
            color: white;
            border-radius: 50%;
            width: 2.4rem;
            height: 2.4rem;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .message-card, .subscription-card {
            background: var(--white);
            border-radius: var(--radius-md);
            box-shadow: var(--shadow-sm);
            padding: 2rem;
            margin-bottom: 2rem;
            transition: all 0.3s ease;
        }
        
        .message-card:hover, .subscription-card:hover {
            box-shadow: var(--shadow-md);
        }
        
        .message-header, .subscription-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.6rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid #f0f0f0;
        }
        
        .message-sender {
            font-weight: 600;
            font-size: 1.8rem;
        }
        
        .message-date, .subscription-date {
            color: #666;
            font-size: 1.4rem;
        }
        
        .message-subject {
            font-weight: 500;
            margin-bottom: 1rem;
            color: #333;
        }
        
        .message-content {
            color: #555;
            line-height: 1.6;
            margin-bottom: 1.6rem;
        }
        
        .message-email, .subscription-email {
            display: inline-flex;
            align-items: center;
            color: var(--primary-color);
            font-size: 1.4rem;
        }
        
        .message-email i, .subscription-email i {
            margin-right: 0.8rem;
        }
        
        .message-actions, .subscription-actions {
            display: flex;
            justify-content: flex-end;
            gap: 1rem;
            margin-top: 1.6rem;
        }
        
        .btn {
            padding: 0.8rem 1.6rem;
            border-radius: var(--radius-sm);
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            border: none;
        }
        
        .btn-primary {
            background-color: var(--primary-color);
            color: var(--white);
        }
        
        .btn-danger {
            background-color: #f44336;
            color: var(--white);
        }
        
        .btn-primary:hover, .btn-danger:hover {
            opacity: 0.9;
        }
        
        .empty-state {
            text-align: center;
            padding: 8rem 2rem;
            background-color: #f9f9f9;
            border-radius: var(--radius-md);
        }
        
        .empty-state i {
            font-size: 5rem;
            color: #ccc;
            margin-bottom: 2rem;
        }
        
        .empty-state h3 {
            font-size: 2rem;
            color: #555;
            margin-bottom: 1rem;
        }
        
        .empty-state p {
            color: #777;
            margin-bottom: 2rem;
        }
        
        .subscription-source {
            display: inline-block;
            background-color: #e3f2fd;
            color: #1565c0;
            padding: 0.4rem 0.8rem;
            border-radius: var(--radius-sm);
            font-size: 1.2rem;
            margin-top: 1rem;
        }
    </style>
</head>
<body>
    <header class="header">
        <div class="container">
            <div class="header-content">
                <div class="logo">
                    <a href="index.html">
                        <i class="fas fa-paper-plane"></i>
                        <span>TravelEase</span>
                    </a>
                </div>
                <nav class="nav-menu">
                    <ul>
                        <li><a href="index.html">Home</a></li>
                        <li><a href="about.html">About</a></li>
                        <li><a href="recommendations.html">Recommendations</a></li>
                        <li><a href="contact.html">Contact Us</a></li>
                    </ul>
                </nav>
                <div class="user-actions">
                    <a href="profile.html" class="profile-link">
                        <i class="fas fa-user-circle"></i>
                        <span>My Profile</span>
                    </a>
                </div>
                <div class="mobile-menu-btn">
                    <i class="fas fa-bars"></i>
                </div>
            </div>
        </div>
    </header>

    <div class="admin-panel">
        <div class="admin-header">
            <h1 class="admin-title">Admin Dashboard</h1>
            <div class="admin-actions">
                <button id="clear-all-messages" class="btn btn-danger">
                    <i class="fas fa-trash"></i> Clear Messages
                </button>
                <button id="clear-all-subscriptions" class="btn btn-danger">
                    <i class="fas fa-trash"></i> Clear Subscriptions
                </button>
            </div>
        </div>
        
        <div class="admin-tabs">
            <div class="tab active" data-tab="messages">
                <i class="fas fa-envelope"></i> Contact Messages
                <span class="count-badge" id="messages-count">0</span>
            </div>
            <div class="tab" data-tab="subscriptions">
                <i class="fas fa-paper-plane"></i> Email Subscriptions
                <span class="count-badge" id="subscriptions-count">0</span>
            </div>
        </div>
        
        <div class="tab-content active" id="messages-container">
            <!-- Messages will be populated here by JavaScript -->
        </div>
        
        <div class="tab-content" id="subscriptions-container">
            <!-- Subscriptions will be populated here by JavaScript -->
        </div>
    </div>

    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-logo">
                    <a href="index.html">
                        <i class="fas fa-paper-plane"></i>
                        <span>TravelEase</span>
                    </a>
                    <p>Making travel planning simple and enjoyable.</p>
                </div>
                <div class="footer-links">
                    <div class="footer-column">
                        <h3>Quick Links</h3>
                        <ul>
                            <li><a href="index.html">Home</a></li>
                            <li><a href="about.html">About Us</a></li>
                            <li><a href="packages.html">Packages</a></li>
                            <li><a href="blog.html">Travel Blog</a></li>
                            <li><a href="contact.html">Contact Us</a></li>
                        </ul>
                    </div>
                    <div class="footer-column">
                        <h3>Top Destinations</h3>
                        <ul>
                            <li><a href="#">Bali, Indonesia</a></li>
                            <li><a href="#">Paris, France</a></li>
                            <li><a href="#">Tokyo, Japan</a></li>
                            <li><a href="#">Santorini, Greece</a></li>
                            <li><a href="#">New York, USA</a></li>
                        </ul>
                    </div>
                    <div class="footer-column">
                        <h3>Support</h3>
                        <ul>
                            <li><a href="#">FAQs</a></li>
                            <li><a href="#">Terms & Conditions</a></li>
                            <li><a href="#">Privacy Policy</a></li>
                            <li><a href="#">Cancellation Policy</a></li>
                            <li><a href="#">Customer Support</a></li>
                        </ul>
                    </div>
                </div>
            </div>
            <div class="footer-bottom">
                <div class="social-icons">
                    <a href="#"><i class="fab fa-facebook-f"></i></a>
                    <a href="#"><i class="fab fa-twitter"></i></a>
                    <a href="#"><i class="fab fa-instagram"></i></a>
                    <a href="#"><i class="fab fa-pinterest-p"></i></a>
                </div>
                <p class="copyright">© 2023 TravelEase. All Rights Reserved.</p>
            </div>
        </div>
    </footer>

    <script src="js/script.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const messagesContainer = document.getElementById('messages-container');
            const subscriptionsContainer = document.getElementById('subscriptions-container');
            const clearAllMessagesBtn = document.getElementById('clear-all-messages');
            const clearAllSubscriptionsBtn = document.getElementById('clear-all-subscriptions');
            const messagesCountBadge = document.getElementById('messages-count');
            const subscriptionsCountBadge = document.getElementById('subscriptions-count');
            const tabs = document.querySelectorAll('.tab');
            const tabContents = document.querySelectorAll('.tab-content');
            
            // Tab switching functionality
            tabs.forEach(tab => {
                tab.addEventListener('click', function() {
                    const tabId = this.getAttribute('data-tab');
                    
                    // Update active tab
                    tabs.forEach(t => t.classList.remove('active'));
                    this.classList.add('active');
                    
                    // Update active tab content
                    tabContents.forEach(content => content.classList.remove('active'));
                    document.getElementById(tabId + '-container').classList.add('active');
                });
            });
            
            // Format date in a readable way
            function formatDate(dateString) {
                const options = { 
                    year: 'numeric', 
                    month: 'long', 
                    day: 'numeric',
                    hour: '2-digit',
                    minute: '2-digit'
                };
                return new Date(dateString).toLocaleDateString('en-US', options);
            }
            
            // Function to display messages
            function displayMessages() {
                // Get messages from localStorage
                const submissions = JSON.parse(localStorage.getItem('contactSubmissions') || '[]');
                
                // Update count badge
                messagesCountBadge.textContent = submissions.length;
                
                // Clear container
                messagesContainer.innerHTML = '';
                
                if (submissions.length === 0) {
                    // Display empty state
                    messagesContainer.innerHTML = `
                        <div class="empty-state">
                            <i class="far fa-envelope-open"></i>
                            <h3>No Messages Yet</h3>
                            <p>No contact form submissions have been received yet.</p>
                            <a href="contact.html" class="btn btn-primary">Go to Contact Form</a>
                        </div>
                    `;
                    return;
                }
                
                // Display messages in reverse order (newest first)
                submissions.slice().reverse().forEach((submission, index) => {
                    const messageCard = document.createElement('div');
                    messageCard.className = 'message-card';
                    messageCard.dataset.index = submissions.length - 1 - index; // Store original index for deletion
                    
                    messageCard.innerHTML = `
                        <div class="message-header">
                            <div class="message-sender">${submission.name}</div>
                            <div class="message-date">${formatDate(submission.timestamp)}</div>
                        </div>
                        <div class="message-subject">${submission.subject || 'No Subject'}</div>
                        <div class="message-content">${submission.message}</div>
                        <div class="message-email">
                            <i class="fas fa-envelope"></i>
                            <a href="mailto:${submission.email}">${submission.email}</a>
                        </div>
                        <div class="message-actions">
                            <button class="btn btn-primary reply-msg-btn">
                                <i class="fas fa-reply"></i> Reply
                            </button>
                            <button class="btn btn-danger delete-msg-btn">
                                <i class="fas fa-trash"></i> Delete
                            </button>
                        </div>
                    `;
                    
                    messagesContainer.appendChild(messageCard);
                });
                
                // Add event listeners to delete buttons
                document.querySelectorAll('.delete-msg-btn').forEach(btn => {
                    btn.addEventListener('click', function() {
                        const card = this.closest('.message-card');
                        const index = card.dataset.index;
                        
                        if (confirm('Are you sure you want to delete this message?')) {
                            const submissions = JSON.parse(localStorage.getItem('contactSubmissions') || '[]');
                            submissions.splice(index, 1);
                            localStorage.setItem('contactSubmissions', JSON.stringify(submissions));
                            
                            displayMessages(); // Refresh display
                        }
                    });
                });
                
                // Add event listeners to reply buttons
                document.querySelectorAll('.reply-msg-btn').forEach(btn => {
                    btn.addEventListener('click', function() {
                        const card = this.closest('.message-card');
                        const index = card.dataset.index;
                        const submissions = JSON.parse(localStorage.getItem('contactSubmissions') || '[]');
                        const submission = submissions[index];
                        
                        // Open email client with pre-filled data
                        window.location.href = `mailto:${submission.email}?subject=Re: ${submission.subject || 'Your Contact Form Submission'}&body=Dear ${submission.name},\n\nThank you for your message. In response to your inquiry:\n\n`;
                    });
                });
            }
            
            // Function to display subscriptions
            function displaySubscriptions() {
                // Get subscriptions from localStorage
                const subscriptions = JSON.parse(localStorage.getItem('emailSubscriptions') || '[]');
                
                // Update count badge
                subscriptionsCountBadge.textContent = subscriptions.length;
                
                // Clear container
                subscriptionsContainer.innerHTML = '';
                
                if (subscriptions.length === 0) {
                    // Display empty state
                    subscriptionsContainer.innerHTML = `
                        <div class="empty-state">
                            <i class="far fa-paper-plane"></i>
                            <h3>No Subscriptions Yet</h3>
                            <p>No newsletter subscriptions have been received yet.</p>
                            <a href="recommendations.html" class="btn btn-primary">Go to Newsletter Form</a>
                        </div>
                    `;
                    return;
                }
                
                // Display subscriptions in reverse order (newest first)
                subscriptions.slice().reverse().forEach((subscription, index) => {
                    const subscriptionCard = document.createElement('div');
                    subscriptionCard.className = 'subscription-card';
                    subscriptionCard.dataset.index = subscriptions.length - 1 - index; // Store original index for deletion
                    
                    subscriptionCard.innerHTML = `
                        <div class="subscription-header">
                            <div class="subscription-email">
                                <i class="fas fa-envelope"></i>
                                <a href="mailto:${subscription.email}">${subscription.email}</a>
                            </div>
                            <div class="subscription-date">${formatDate(subscription.timestamp)}</div>
                        </div>
                        <div class="subscription-source">
                            <i class="fas fa-info-circle"></i> Subscribed from: ${subscription.source || 'Website'}
                        </div>
                        <div class="subscription-actions">
                            <button class="btn btn-primary send-newsletter-btn">
                                <i class="fas fa-paper-plane"></i> Send Newsletter
                            </button>
                            <button class="btn btn-danger delete-sub-btn">
                                <i class="fas fa-trash"></i> Delete
                            </button>
                        </div>
                    `;
                    
                    subscriptionsContainer.appendChild(subscriptionCard);
                });
                
                // Add event listeners to delete buttons
                document.querySelectorAll('.delete-sub-btn').forEach(btn => {
                    btn.addEventListener('click', function() {
                        const card = this.closest('.subscription-card');
                        const index = card.dataset.index;
                        
                        if (confirm('Are you sure you want to delete this subscription?')) {
                            const subscriptions = JSON.parse(localStorage.getItem('emailSubscriptions') || '[]');
                            subscriptions.splice(index, 1);
                            localStorage.setItem('emailSubscriptions', JSON.stringify(subscriptions));
                            
                            displaySubscriptions(); // Refresh display
                        }
                    });
                });
                
                // Add event listeners to send newsletter buttons
                document.querySelectorAll('.send-newsletter-btn').forEach(btn => {
                    btn.addEventListener('click', function() {
                        const card = this.closest('.subscription-card');
                        const index = card.dataset.index;
                        const subscriptions = JSON.parse(localStorage.getItem('emailSubscriptions') || '[]');
                        const subscription = subscriptions[index];
                        
                        // Open email client with pre-filled data
                        window.location.href = `mailto:${subscription.email}?subject=TravelEase Newsletter: Latest Travel Deals&body=Dear Subscriber,\n\nThank you for subscribing to our newsletter. Here are our latest travel deals and recommendations:\n\n`;
                    });
                });
            }
            
            // Initialize - display messages and subscriptions
            displayMessages();
            displaySubscriptions();
            
            // Clear all messages
            clearAllMessagesBtn.addEventListener('click', function() {
                if (confirm('Are you sure you want to delete ALL messages? This cannot be undone.')) {
                    localStorage.removeItem('contactSubmissions');
                    displayMessages(); // Refresh display
                }
            });
            
            // Clear all subscriptions
            clearAllSubscriptionsBtn.addEventListener('click', function() {
                if (confirm('Are you sure you want to delete ALL subscriptions? This cannot be undone.')) {
                    localStorage.removeItem('emailSubscriptions');
                    displaySubscriptions(); // Refresh display
                }
            });
        });
    </script>
</body>
</html> 